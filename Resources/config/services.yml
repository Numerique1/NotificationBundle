parameters:
# EVENT
    # Factory
    numerique1_notification.event.factory.pre_build_notification_event_factory.class: 'Numerique1\Bundle\NotificationBundle\Event\Factory\PreBuildNotificationEventFactory'
# RULE
    #Provider
    numerique1_notification.rule.rule_provider.class: 'Numerique1\Bundle\NotificationBundle\Rule\RuleProvider'
# BUILDER
    # Container
    numerique1_notification.factory.notification_factory_container.class: 'Numerique1\Bundle\NotificationBundle\Factory\NotificationFactoryContainer'
# POOL
    numerique1_notification.notification_pool.class: 'Numerique1\Bundle\NotificationBundle\Pool\NotificationPool'

services:
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.
        public: false       # Allows optimizing the container by removing unused services; this also means
                            # fetching services directly from the container via $container->get() won't work.
                            # The best practice is to be explicit about your dependencies anyway.
#EVENT
    # Factory
    numerique1_notification.event.factory.pre_build_notification_event_factory:
        class: '%numerique1_notification.event.factory.pre_build_notification_event_factory.class%'
        arguments:
            - '@numerique1_notification.rule.rule_provider'

    # Handler
    Numerique1\Bundle\NotificationBundle\Event\Handler\NotificationFactoryHandler:
      tags:
        - { name: numerique1_notification.event_subscriber }
      arguments: ['@event_dispatcher', '@numerique1_notification.factory.notification_factory_container']

   # Listener
    Numerique1\Bundle\NotificationBundle\Event\Listener\NotificationDoctrineListener:
      arguments: ['@event_dispatcher', '@numerique1_notification.event.factory.pre_build_notification_event_factory']
      tags:
        - { name: doctrine.event_subscriber }

#RULE
    #Provider
    numerique1_notification.rule.rule_provider:
        class: '%numerique1_notification.rule.rule_provider.class%'
        arguments:
            - '@service_container'
            - '%numerique1_notification.notifications%'
#BUILDER
    #Container
    numerique1_notification.factory.notification_factory_container:
        class: '%numerique1_notification.factory.notification_factory_container.class%'
        lazy: true

#POOL
    numerique1_notification.notification_pool:
        class: '%numerique1_notification.notification_pool.class%'
        tags:
            - {name: doctrine.event_listener, event: postFlush }

